(this["webpackJsonpgraph-tutorial"]=this["webpackJsonpgraph-tutorial"]||[]).push([[0],{29:function(e,t){e.exports={appId:"b5bec270-f009-4efa-aa2b-7142e4fa7c2f",redirectUri:"http://localhost:3000",scopes:["user.read","calendars.read"]}},60:function(e,t,a){e.exports=a(86)},65:function(e,t,a){},86:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(33),c=a.n(s),i=(a(65),a(2)),l=a.n(i),o=a(24),u=a(5),h=a(7),p=a(19),m=a(15),d=a(18),f=a(31),g=a(25),b=a(91),E=a(58),v=a(11),O=a(101),k=a(100),y=a(99),j=a(87),x=a(88),A=a(89),w=a(90),N=a(92),S=a(93),C=a(94),M=a(95);a(67);function B(e){return e.user.avatar?r.a.createElement("img",{src:e.user.avatar,alt:"user",className:"rounded-circle align-self-center mr-2",style:{width:"32px"}}):r.a.createElement("i",{className:"far fa-user-circle fa-lg rounded-circle align-self-center mr-2",style:{width:"32px"}})}function T(e){return e.isAuthenticated?r.a.createElement(O.a,null,r.a.createElement(k.a,{nav:!0,caret:!0},r.a.createElement(B,{user:e.user})),r.a.createElement(y.a,{right:!0},r.a.createElement("h5",{className:"dropdown-item-text mb-0"},e.user.displayName),r.a.createElement("p",{className:"dropdown-item-text text-muted mb-0"},e.user.email),r.a.createElement(j.a,{divider:!0}),r.a.createElement(j.a,{onClick:e.authButtonMethod},"Sign Out"))):r.a.createElement(x.a,null,r.a.createElement(A.a,{onClick:e.authButtonMethod},"Sign In"))}var I=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e))).toggle=a.toggle.bind(Object(v.a)(a)),a.state={isOpen:!1},a}return Object(d.a)(t,e),Object(h.a)(t,[{key:"toggle",value:function(){this.setState({isOpen:!this.state.isOpen})}},{key:"render",value:function(){var e=null;return this.props.isAuthenticated&&(e=r.a.createElement(x.a,null,r.a.createElement(f.b,{to:"/calendar",className:"nav-link",exact:!0},"Calendar"))),r.a.createElement("div",null,r.a.createElement(w.a,{color:"dark",dark:!0,expand:"md",fixed:"top"},r.a.createElement(b.a,null,r.a.createElement(N.a,{href:"/"},"React Graph Tutorial"),r.a.createElement(S.a,{onClick:this.toggle}),r.a.createElement(C.a,{isOpen:this.state.isOpen,navbar:!0},r.a.createElement(M.a,{className:"mr-auto",navbar:!0},r.a.createElement(x.a,null,r.a.createElement(f.b,{to:"/",className:"nav-link",exact:!0},"Home")),e),r.a.createElement(M.a,{className:"justify-content-end",navbar:!0},r.a.createElement(x.a,null,r.a.createElement(A.a,{href:"https://developer.microsoft.com/graph/docs/concepts/overview",target:"_blank"},r.a.createElement("i",{className:"fas fa-external-link-alt mr-1"}),"Docs")),r.a.createElement(T,{isAuthenticated:this.props.isAuthenticated,authButtonMethod:this.props.authButtonMethod,user:this.props.user}))))))}}]),t}(r.a.Component),P=a(98),U=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=null;return this.props.debug&&(e=r.a.createElement("pre",{className:"alert-pre border bg-light p-2"},r.a.createElement("code",null,this.props.debug))),r.a.createElement(P.a,{color:"danger"},r.a.createElement("p",{className:"mb-3"},this.props.message),e)}}]),t}(r.a.Component),D=a(53),J=a(96);function R(e){return e.isAuthenticated?r.a.createElement("div",null,r.a.createElement("h4",null,"Welcome ",e.user.displayName,"!"),r.a.createElement("p",null,"Use the navigation bar at the top of the page to get started.")):r.a.createElement(D.a,{color:"primary",onClick:e.authButtonMethod},"Click here to sign in")}var z=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return r.a.createElement(J.a,null,r.a.createElement("h1",null,"React Graph Tutorial"),r.a.createElement("p",{className:"lead"},"This sample app shows how to use the Microsoft Graph API to access Outlook and OneDrive data from React"),r.a.createElement(R,{isAuthenticated:this.props.isAuthenticated,user:this.props.user,authButtonMethod:this.props.authButtonMethod}))}}]),t}(r.a.Component),G=a(29),W=a.n(G),q=a(85);function Y(e){return q.Client.init({authProvider:function(t){t(null,e.accessToken)}})}function _(e){return H.apply(this,arguments)}function H(){return(H=Object(o.a)(l.a.mark((function e(t){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Y(t),e.next=3,a.api("/me").get();case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e){return $.apply(this,arguments)}function $(){return($=Object(o.a)(l.a.mark((function e(t){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Y(t),e.next=3,a.api("/me/events").select("subject,organizer,start,end").orderby("createdDateTime DESC").get();case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}a(83);var F=a(97),K=a(57),Q=a.n(K);function V(e){return Q.a.utc(e).local().format("M/D/YY h:mm A")}var X=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={events:[]},a}return Object(d.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(o.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.msal.acquireTokenSilent({scopes:W.a.scopes});case 3:return t=e.sent,e.next=6,L(t);case 6:a=e.sent,this.setState({events:a.value}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),this.props.showError("ERROR",JSON.stringify(e.t0));case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Calendar"),r.a.createElement(F.a,null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"col"},"Organizer"),r.a.createElement("th",{scope:"col"},"Subject"),r.a.createElement("th",{scope:"col"},"Start"),r.a.createElement("th",{scope:"col"},"End"))),r.a.createElement("tbody",null,this.state.events.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,e.organizer.emailAddress.name),r.a.createElement("td",null,e.subject),r.a.createElement("td",null,V(e.start.dateTime)),r.a.createElement("td",null,V(e.end.dateTime)))})))))}}]),t}(r.a.Component),Z=function(e){function t(e){var a;Object(u.a)(this,t),a=Object(p.a)(this,Object(m.a)(t).call(this,e)),console.log(JSON.stringify(e)),a.userAgentApplication=new E.a({auth:{clientId:W.a.appId,redirectUri:W.a.redirectUri},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}});var n=a.userAgentApplication.getAccount();return a.state={isAuthenticated:null!==n,user:{},error:null},n&&a.getUserProfile(),a}return Object(d.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=null;return this.state.error&&(t=r.a.createElement(U,{message:this.state.error.message,debug:this.state.error.debug})),r.a.createElement(f.a,null,r.a.createElement("div",null,r.a.createElement(I,{isAuthenticated:this.state.isAuthenticated,authButtonMethod:this.state.isAuthenticated?this.logout.bind(this):this.login.bind(this),user:this.state.user}),r.a.createElement(b.a,null,t,r.a.createElement(g.a,{exact:!0,path:"/",render:function(t){return r.a.createElement(z,Object.assign({},t,{isAuthenticated:e.state.isAuthenticated,user:e.state.user,authButtonMethod:e.login.bind(e)}))}}),r.a.createElement(g.a,{exact:!0,path:"/calendar",render:function(t){return r.a.createElement(X,Object.assign({},t,{showError:e.setErrorMessage.bind(e)}))}}))))}},{key:"setErrorMessage",value:function(e,t){this.setState({error:{message:e,debug:t}})}},{key:"login",value:function(){var e=Object(o.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.userAgentApplication.loginPopup({scopes:W.a.scopes,prompt:"select_account"});case 3:return e.next=5,this.getUserProfile();case 5:e.next=12;break;case 7:e.prev=7,e.t0=e.catch(0),t={},"string"===typeof e.t0?(a=e.t0.split("|"),t=a.length>1?{message:a[1],debug:a[0]}:{message:e.t0}):t={message:e.t0.message,debug:JSON.stringify(e.t0)},this.setState({isAuthenticated:!1,user:{},error:t});case 12:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){this.userAgentApplication.logout()}},{key:"getUserProfile",value:function(){var e=Object(o.a)(l.a.mark((function e(){var t,a,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.userAgentApplication.acquireTokenSilent({scopes:W.a.scopes});case 3:if(!(t=e.sent)){e.next=9;break}return e.next=7,_(t);case 7:a=e.sent,this.setState({isAuthenticated:!0,user:{displayName:a.displayName,email:a.mail||a.userPrincipalName},error:null});case 9:e.next=16;break;case 11:e.prev=11,e.t0=e.catch(0),n={},"string"===typeof e.t0?(r=e.t0.split("|"),n=r.length>1?{message:r[1],debug:r[0]}:{message:e.t0}):n={message:e.t0.message,debug:JSON.stringify(e.t0)},this.setState({isAuthenticated:!1,user:{},error:n});case 16:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(){return e.apply(this,arguments)}}()}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(Z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[60,1,2]]]);
//# sourceMappingURL=main.0de6c268.chunk.js.map