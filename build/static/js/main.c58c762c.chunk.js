(this["webpackJsonpmini-kaios"]=this["webpackJsonpmini-kaios"]||[]).push([[0],{132:function(e,t,a){e.exports=a(271)},137:function(e,t,a){},151:function(e,t,a){},152:function(e,t,a){},155:function(e,t,a){},162:function(e,t,a){},271:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(29),c=a.n(s),i=(a(137),a(1)),o=a.n(i),l=a(4),u=a(5),d=a(25),v=a(18),m=a(26),p=a(56),h=a(27),g=a(129),f=a(273),b=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=null;return this.props.debug&&(e=r.a.createElement("pre",{className:"alert-pre border bg-light p-2"},r.a.createElement("code",null,this.props.debug))),r.a.createElement(f.a,{color:"danger"},r.a.createElement("p",{className:"mb-3"},this.props.message),e)}}]),t}(r.a.Component),E=a(30),y=a.n(E),w=a(270);function j(e){return w.Client.init({authProvider:function(t){t(null,e.accessToken)}})}function O(e){var t,a;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=j(e),n.next=3,o.a.awrap(t.api("/me").get());case 3:return a=n.sent,n.abrupt("return",a);case 5:case"end":return n.stop()}}))}function k(e,t){var a,n;return o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=j(e),!1!==t){r.next=3;break}return r.abrupt("return");case 3:return r.next=5,o.a.awrap(a.api("/me/events").orderby("createdDateTime DESC").select(t).get());case 5:return n=r.sent,r.abrupt("return",n);case 7:case"end":return r.stop()}}))}a(150),a(151);var x=function(e){var t=e.start;return r.a.createElement("div",{className:"header_4"},r.a.createElement("div",{className:"header_5"},r.a.createElement("div",{className:"header_6"},t[0]," ",t[2])))},N=(a(152),function(e){var t=e.start,a=e.duration,n=e.subject,s=e.location,c=encodeURIComponent(e["@odata.etag"]);return r.a.createElement(p.b,{className:"calendar_3",to:"/event-details/".concat(c)},r.a.createElement("div",{className:"calendar_4"},r.a.createElement("div",{className:"calendar_5"},t&&t[1]),r.a.createElement("div",{className:"calendar_6"},a)),r.a.createElement("div",{className:"calendar_7"},r.a.createElement("div",{className:"calendar_8"})),r.a.createElement("div",{className:"calendar_9"},r.a.createElement("div",{className:"calendar_12"},r.a.createElement("div",{className:"calendar_13"},r.a.createElement("div",{className:"calendar_14"},n)),s&&r.a.createElement("div",{className:"calendar_15"},r.a.createElement("span",{role:"img"},"\ud83d\udccd"),s))))}),A=(a(155),a(130)),T=a(37),_=Object(T.createStore)("calendarStore",{events:{value:[]}}),C=Object(T.mutatorAction)("UPDATE_CALENDAR_ITEMS_MAP",(function(e){_().events.value=e.value})),S=a(127),D=a(82);function M(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return["","","","",""];var a,n,r,s=e.split("T"),c=Object(D.a)(s,2),i=c[0],o=c[1],l=o.split(".")[0].split(":"),u=Object(D.a)(l,2),d=u[0],v=u[1],m=new Date(i),p=m.getDate(),h=(new Date).getDate();t&&(p===h?a="Today":p===h-1?a="Yesterday":p===h+1&&(a="Tomorrow"));var g=["".concat(d,":").concat(v),a||m.toLocaleString("en-us",{weekday:"long"}),i];n=g[0],a=g[1],r=g[2];var f=p===h?n:m.getMonth()+"/"+p+" "+n;return[p,n,a,r,f]}a(8);var R=function(){var e,t=null===(e=_())||void 0===e?void 0:e.events;try{var a={};return t.value.forEach((function(e){var t,n,r,s,c,i=M(null===e||void 0===e?void 0:null===(t=e.start)||void 0===t?void 0:t.dateTime),o=M(null===e||void 0===e?void 0:null===(n=e.end)||void 0===n?void 0:n.dateTime),l=function(e,t){var a=Math.abs(new Date(e)-new Date(t)),n=Math.floor(a/36e5);a-=36e5*n;var r=Math.floor(a/6e4);return"".concat(n,":").concat(("0"+r).slice(-2))}(null===e||void 0===e?void 0:null===(r=e.end)||void 0===r?void 0:r.dateTime,null===e||void 0===e?void 0:null===(s=e.start)||void 0===s?void 0:s.dateTime);a[i[3]]=a[i[3]]||[];var u=Object(S.a)({},e,{itemId:null===e||void 0===e?void 0:e.id,subject:null===e||void 0===e?void 0:e.subject,isRead:!0,start:i,end:o,location:null===e||void 0===e?void 0:null===(c=e.location)||void 0===c?void 0:c.displayName,duration:l});a[i[3]].push(u)})),a}catch(n){console.log("Error : "+n)}},U=Object(A.a)(function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e,t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,o.a.awrap(window.msal.acquireTokenSilent({scopes:y.a.scopes}));case 3:return e=a.sent,a.next=6,o.a.awrap(k(e,this.props.select));case 6:(t=a.sent)&&C(t),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(0),console.error("ERROR",a.t0);case 13:case"end":return a.stop()}}),null,this,[[0,10]])}},{key:"render",value:function(){var e,t,a,n=R(),s=Object.keys(n).sort(),c=null===this||void 0===this?void 0:null===(e=this.props)||void 0===e?void 0:null===(t=e.match)||void 0===t?void 0:null===(a=t.params)||void 0===a?void 0:a.etag;if(c){var i,o=function(e){var t,a,n=null===(t=_())||void 0===t?void 0:t.events,r=decodeURIComponent(e);return null===n||void 0===n?void 0:null===(a=n.value)||void 0===a?void 0:a.find((function(e){return(null===e||void 0===e?void 0:e["@odata.etag"])===r}))}(c);return r.a.createElement("div",{dangerouslySetInnerHTML:{__html:null===o||void 0===o?void 0:null===(i=o.body)||void 0===i?void 0:i.content}})}return r.a.createElement("div",{className:"mailListContainer"},s.map((function(e,t){var a;return r.a.createElement(r.a.Fragment,{key:t},r.a.createElement(x,{start:null===(a=n[e][0])||void 0===a?void 0:a.start}),n[e].map((function(e,t){return r.a.createElement(N,Object.assign({key:t},e))})))})))}}]),t}(r.a.Component)),I=(a(162),function(e){var t=e.headerText;return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"header-item"},r.a.createElement("span",null,t)))}),P=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(I,e),r.a.createElement(U,e))},L=function(e){function t(e){var a;Object(l.a)(this,t),((a=Object(d.a)(this,Object(v.a)(t).call(this,e))).userAgentApplication=new g.a({auth:{clientId:y.a.appId,navigateToLoginRequestUrl:!1,redirectUri:y.a.redirectUri}})).handleRedirectCallback((function(e,t){console.log(e,t.accessToken,t)}));var n=a.userAgentApplication.getAccount();return a.state={isAuthenticated:null!==n,user:{},error:null},n?a.getUserProfile():a.login(),a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.state.user;return this.state.error&&r.a.createElement(b,{message:this.state.error.message,debug:this.state.error.debug}),r.a.createElement(p.a,null,r.a.createElement(h.a,{exact:!0,path:"/",render:function(a){return r.a.createElement(P,Object.assign({},a,{headerText:"Calendar",user:t,showError:e.setErrorMessage.bind(e),select:"id,subject,start,end,location,body"}))}}),r.a.createElement(h.a,{exact:!0,path:"/event-details/:etag",render:function(a,n){return r.a.createElement(P,Object.assign({},a,{params:n,headerText:"Calendar Details",user:t,showError:e.setErrorMessage.bind(e),select:!1}))}}))}},{key:"setErrorMessage",value:function(e,t){this.setState({error:{message:e,debug:t}})}},{key:"login",value:function(){var e,t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,o.a.awrap(this.userAgentApplication.loginPopup({scopes:y.a.scopes,prompt:"select_account"}));case 3:return a.next=5,o.a.awrap(this.getUserProfile());case 5:a.next=12;break;case 7:a.prev=7,a.t0=a.catch(0),e={},"string"===typeof a.t0?(t=a.t0.split("|"),e=t.length>1?{message:t[1],debug:t[0]}:{message:a.t0}):e={message:a.t0.message,debug:JSON.stringify(a.t0)},this.setState({isAuthenticated:!1,user:{},error:e});case 12:case"end":return a.stop()}}),null,this,[[0,7]])}},{key:"logout",value:function(){this.userAgentApplication.logout()}},{key:"getUserProfile",value:function(){var e,t,a,n;return o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,o.a.awrap(this.userAgentApplication.acquireTokenSilent({scopes:y.a.scopes}));case 3:if(!(e=r.sent)){r.next=10;break}return r.next=7,o.a.awrap(O(e));case 7:t=r.sent,this.setState({isAuthenticated:!0,user:{displayName:t.displayName,email:t.mail||t.userPrincipalName},error:null}),document.head.getElementsByTagName("title")[0].text="Calendar - ".concat(t.displayName," - Outlook");case 10:r.next=17;break;case 12:r.prev=12,r.t0=r.catch(0),a={},"string"===typeof r.t0?(n=r.t0.split("|"),a=n.length>1?{message:n[1],debug:n[0]}:{message:r.t0}):a={message:r.t0.message,debug:JSON.stringify(r.t0)},this.setState({isAuthenticated:!1,user:{},error:a});case 17:case"end":return r.stop()}}),null,this,[[0,12]])}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var J=a(128);!function(){var e=new RegExp("[\\?&]devtools="),t=window.location.href.toLowerCase();e.exec(t)&&Object(T.applyMiddleware)(a(164).default,J.trace),c.a.render(r.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}()},30:function(e,t){e.exports={appId:"98f6c11f-26a7-4309-a75f-b8df6e384711",redirectUri:"http://localhost:3000/",scopes:["user.read","calendars.read"]}}},[[132,1,2]]]);
//# sourceMappingURL=main.c58c762c.chunk.js.map