(this["webpackJsonpmini-kaios"]=this["webpackJsonpmini-kaios"]||[]).push([[0],{236:function(e,t,a){e.exports=a(510)},482:function(e,t,a){},495:function(e,t,a){},496:function(e,t,a){},499:function(e,t,a){},506:function(e,t,a){},510:function(e,t,a){"use strict";a.r(t);a(237),a(286);var n=a(1),r=a.n(n),o=a(111),s=a.n(o),c=(a(482),a(113)),i=a(2),l=a.n(i),u=a(59),d=a(7),v=a(8),m=a(58),p=a(57),g=a(114),h=a(60),f=a(234),b=a(512),E=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"render",value:function(){var e=null;return this.props.debug&&(e=r.a.createElement("pre",{className:"alert-pre border bg-light p-2"},r.a.createElement("code",null,this.props.debug))),r.a.createElement(b.a,{color:"danger"},r.a.createElement("p",{className:"mb-3"},this.props.message),e)}}]),a}(r.a.Component),k=a(69),y=a.n(k),O=a(509);function w(e){return O.Client.init({authProvider:function(t){t(null,e.accessToken)}})}function j(e){return x.apply(this,arguments)}function x(){return(x=Object(u.a)(l.a.mark((function e(t){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getUserDetails"),a=w(t),e.next=4,a.api("/me").get();case 4:return n=e.sent,console.log("getUserDetails: user",n),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t){return T.apply(this,arguments)}function T(){return(T=Object(u.a)(l.a.mark((function e(t,a){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=w(t),!1!==a){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,n.api("/me/events").orderby("createdDateTime DESC").select(a).get();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}a(495);var A=function(e){var t=e.start;return r.a.createElement("div",{className:"header_4"},r.a.createElement("div",{className:"header_5"},r.a.createElement("div",{className:"header_6"},t[0]," ",t[2])))},_=(a(496),function(e){var t=e.start,a=e.duration,n=e.subject,o=e.location,s=encodeURIComponent(e["@odata.etag"]);return r.a.createElement(g.b,{className:"calendar_3",to:"/event-details/".concat(s)},r.a.createElement("div",{className:"calendar_4"},r.a.createElement("div",{className:"calendar_5"},t&&t[1]),r.a.createElement("div",{className:"calendar_6"},a)),r.a.createElement("div",{className:"calendar_7"},r.a.createElement("div",{className:"calendar_8"})),r.a.createElement("div",{className:"calendar_9"},r.a.createElement("div",{className:"calendar_12"},r.a.createElement("div",{className:"calendar_13"},r.a.createElement("div",{className:"calendar_14"},n)),o&&r.a.createElement("div",{className:"calendar_15"},r.a.createElement("span",{role:"img"},"\ud83d\udccd"),o))))}),S=(a(499),a(233)),C=a(90),D=Object(C.createStore)("calendarStore",{events:{value:[]}}),U=Object(C.mutatorAction)("UPDATE_CALENDAR_ITEMS_MAP",(function(e){D().events.value=e.value})),M=a(150);function R(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return["","","","",""];var a,n,r,o=e.split("T"),s=Object(M.a)(o,2),c=s[0],i=s[1],l=i.split(".")[0].split(":"),u=Object(M.a)(l,2),d=u[0],v=u[1],m=new Date(c),p=m.getDate(),g=(new Date).getDate();t&&(p===g?a="Today":p===g-1?a="Yesterday":p===g+1&&(a="Tomorrow"));var h=["".concat(d,":").concat(v),a||m.toLocaleString("en-us",{weekday:"long"}),c];n=h[0],a=h[1],r=h[2];var f=p===g?n:m.getMonth()+"/"+p+" "+n;return[p,n,a,r,f]}a(11);var I,P=function(){var e,t=null===(e=D())||void 0===e?void 0:e.events;try{var a={};return t.value.forEach((function(e){var t,n,r,o,s,i=R(null===e||void 0===e||null===(t=e.start)||void 0===t?void 0:t.dateTime),l=R(null===e||void 0===e||null===(n=e.end)||void 0===n?void 0:n.dateTime),u=function(e,t){var a=Math.abs(new Date(e)-new Date(t)),n=Math.floor(a/36e5);a-=36e5*n;var r=Math.floor(a/6e4);return"".concat(n,":").concat(("0"+r).slice(-2))}(null===e||void 0===e||null===(r=e.end)||void 0===r?void 0:r.dateTime,null===e||void 0===e||null===(o=e.start)||void 0===o?void 0:o.dateTime);a[i[3]]=a[i[3]]||[];var d=Object(c.a)({},e,{itemId:null===e||void 0===e?void 0:e.id,subject:null===e||void 0===e?void 0:e.subject,isRead:!0,start:i,end:l,location:null===e||void 0===e||null===(s=e.location)||void 0===s?void 0:s.displayName,duration:u});a[i[3]].push(d)})),a}catch(n){console.log("Error : "+n)}},J=Object(S.a)(function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.msal.acquireTokenSilent({scopes:y.a.scopes});case 3:return t=e.sent,e.next=6,N(t,this.props.select);case 6:(a=e.sent)&&U(a),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("ERROR",e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,a,n=P(),o=Object.keys(n).sort(),s=null===this||void 0===this||null===(e=this.props)||void 0===e||null===(t=e.match)||void 0===t||null===(a=t.params)||void 0===a?void 0:a.etag;if(s){var c,i=function(e){var t,a,n=null===(t=D())||void 0===t?void 0:t.events,r=decodeURIComponent(e);return null===n||void 0===n||null===(a=n.value)||void 0===a?void 0:a.find((function(e){return(null===e||void 0===e?void 0:e["@odata.etag"])===r}))}(s);return r.a.createElement("div",{dangerouslySetInnerHTML:{__html:null===i||void 0===i||null===(c=i.body)||void 0===c?void 0:c.content}})}return r.a.createElement("div",{className:"mailListContainer"},o.map((function(e,t){var a;return r.a.createElement(r.a.Fragment,{key:t},r.a.createElement(A,{start:null===(a=n[e][0])||void 0===a?void 0:a.start}),n[e].map((function(e,t){return r.a.createElement(_,Object.assign({key:t},e))})))})))}}]),a}(r.a.Component)),L=(a(506),function(e){var t=e.headerText;return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"header-item"},r.a.createElement("span",null,t)))}),q=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(L,e),r.a.createElement(J,e))},B=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(d.a)(this,a),((n=t.call(this,e)).userAgentApplication=new f.a({auth:{clientId:y.a.appId,navigateToLoginRequestUrl:!1,redirectUri:y.a.redirectUri}})).handleRedirectCallback((function(e,t){console.log(e,t.accessToken,t)}));var r=n.userAgentApplication.getAccount();return console.log("got account",r),n.state={isAuthenticated:null!==r,user:null,error:null},r?n.getUserProfile():n.login(),n}return Object(v.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.user,n=t.isAuthenticated;return console.log("user in render",a),this.state.error&&r.a.createElement(E,{message:this.state.error.message,debug:this.state.error.debug}),r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,null,r.a.createElement("pre",null,JSON.stringify(a),JSON.stringify(I),n),r.a.createElement(h.a,{path:"/",render:function(t){return t.history,I=t.location,console.log("matched",t.match.url,n,I),n?r.a.createElement(q,Object.assign({},t,{headerText:"Calendar",user:a,showError:e.setErrorMessage.bind(e),select:"id,subject,start,end,location,body"})):null}}),r.a.createElement(h.a,{exact:!0,path:"/event-details/:etag",render:function(t,n){return r.a.createElement(q,Object.assign({},t,{params:n,headerText:"Calendar Details",user:a,showError:e.setErrorMessage.bind(e),select:!1}))}})))}},{key:"setErrorMessage",value:function(e,t){this.setState({error:{message:e,debug:t}})}},{key:"login",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,a,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.userAgentApplication.loginPopup({scopes:y.a.scopes,prompt:"select_account"});case 3:return t=e.sent,console.log("login popup closed idToken, idTokenClaims",t.idToken,t.idTokenClaims),e.next=7,this.getUserProfile();case 7:a=e.sent,console.log("got User Profile",a),e.next=17;break;case 11:e.prev=11,e.t0=e.catch(0),console.log("got error",e.t0),n={},"string"===typeof e.t0?(r=e.t0.split("|"),n=r.length>1?{message:r[1],debug:r[0]}:{message:e.t0}):n={message:e.t0.message,debug:JSON.stringify(e.t0)},this.setState({isAuthenticated:!1,user:null,error:n});case 17:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){this.userAgentApplication.logout()}},{key:"getUserProfile",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,a,n,r,o,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.userAgentApplication.acquireTokenSilent({scopes:y.a.scopes});case 3:if(!(t=e.sent)){e.next=18;break}return e.prev=5,e.next=8,j(t);case 8:o=e.sent,e.next=15;break;case 11:e.prev=11,e.t0=e.catch(5),console.log(e.t0),console.error(e.t0);case 15:console.log("got acquireTokenSilent, getUserDetails",o,I,I.pathname),this.setState({isAuthenticated:!0,user:Object(c.a)({email:(null===(a=o)||void 0===a?void 0:a.mail)||(null===(n=o)||void 0===n?void 0:n.userPrincipalName)},o),error:null}),document.head.getElementsByTagName("title")[0].text="Calendar - ".concat(null===(r=o)||void 0===r?void 0:r.displayName," - Outlook");case 18:e.next=26;break;case 20:e.prev=20,e.t1=e.catch(0),console.log(e.t1),s={},"string"===typeof e.t1?(i=e.t1.split("|"),s=i.length>1?{message:i[1],debug:i[0]}:{message:e.t1}):(s={message:e.t1.message,debug:JSON.stringify(e.t1)},console.log(s)),this.setState({isAuthenticated:!1,user:{},error:s});case 26:case"end":return e.stop()}}),e,this,[[0,20],[5,11]])})));return function(){return e.apply(this,arguments)}}()}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(507);!function(){new RegExp("[\\?&]devtools="),window.location.href.toLowerCase();s.a.render(r.a.createElement(B,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}()},69:function(e,t){e.exports={appId:"98f6c11f-26a7-4309-a75f-b8df6e384711",redirectUri:"https://outlook-sdf.office.com/mail/inbox",scopes:["user.read","calendars.read"]}}},[[236,1,2]]]);
//# sourceMappingURL=main.5ae2f8e0.chunk.js.map