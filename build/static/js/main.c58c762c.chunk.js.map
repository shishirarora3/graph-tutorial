{"version":3,"sources":["ErrorMessage.js","GraphService.js","calendar/components/CalendarListItemHeader.jsx","calendar/components/CalendarListItem.jsx","calendar/store/getCalendarStore.js","calendar/actions/calendarActions.js","calendar/utils.js","calendar/selectors/getCalendarEvents.js","calendar/components/Calendar.jsx","calendar/components/CalendarHeader.jsx","calendar/components/CalendarBox.jsx","App.js","serviceWorker.js","index.js","Config.js"],"names":["ErrorMessage","debug","this","props","className","Alert","color","message","React","Component","graph","require","getAuthenticatedClient","accessToken","Client","init","authProvider","done","getUserDetails","a","async","client","api","get","user","getEvents","select","orderby","events","CalendarListItemHeader","start","CalendarListItem","duration","subject","location","encodeEtag","encodeURIComponent","to","role","getCalendarStore","createStore","value","updateCalendarItemsMap","mutatorAction","newEvents","getDateTime","datetime","override","day","time","fullDate","split","_date","_time","h","m","__date","Date","date","getDate","currentDate","toLocaleString","weekday","dateTime","getMonth","getParsedEventsMap","dateGroups","forEach","item","end","distance","Math","abs","hours","floor","minutes","slice","getDuration","_item","itemId","id","isRead","displayName","push","err","console","log","Calendar","observer","window","msal","acquireTokenSilent","scopes","config","error","eventsMap","eventKeys","Object","keys","sort","activeEtag","match","params","etag","eventDetails","decodedAcTiveEtag","decodeURIComponent","find","e","getActiveEventDetailsByEtag","dangerouslySetInnerHTML","__html","body","content","map","eventKey","k","Fragment","key","CalendarHeader","headerText","CalendarBox","App","userAgentApplication","UserAgentApplication","auth","clientId","appId","navigateToLoginRequestUrl","redirectUri","handleRedirectCallback","response","getAccount","state","isAuthenticated","getUserProfile","login","exact","path","render","showError","setErrorMessage","bind","setState","loginPopup","prompt","errParts","length","JSON","stringify","logout","email","mail","userPrincipalName","document","head","getElementsByTagName","text","Boolean","hostname","regex","RegExp","url","href","toLowerCase","exec","applyMiddleware","default","trace","ReactDOM","getElementById","navigator","serviceWorker","ready","then","registration","unregister","bootstrap","module","exports"],"mappings":"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","file":"static/js/main.c58c762c.chunk.js","sourcesContent":["import React from 'react';\nimport { Alert } from 'reactstrap';\n\nexport default class ErrorMessage extends React.Component {\n  render() {\n    let debug = null;\n    if (this.props.debug) {\n      debug = <pre className=\"alert-pre border bg-light p-2\"><code>{this.props.debug}</code></pre>;\n    }\n    return (\n      <Alert color=\"danger\">\n        <p className=\"mb-3\">{this.props.message}</p>\n        {debug}\n      </Alert>\n    );\n  }\n}","var graph = require('@microsoft/microsoft-graph-client');\n\nfunction getAuthenticatedClient(accessToken) {\n  // Initialize Graph client\n  const client = graph.Client.init({\n    // Use the provided access token to authenticate\n    // requests\n    authProvider: (done) => {\n      done(null, accessToken.accessToken);\n    }\n  });\n\n  return client;\n}\n\nexport async function getUserDetails(accessToken) {\n  const client = getAuthenticatedClient(accessToken);\n\n  const user = await client.api('/me').get();\n  return user;\n}\n\nexport async function getEvents(accessToken, select) {\n    const client = getAuthenticatedClient(accessToken);\n    if(select === false){\n        return;\n    }\n    const events = await client\n        .api('/me/events')\n        .orderby('createdDateTime DESC')\n        .select(select)\n        .get();\n\n    return events;\n}","import React from 'react';\nimport \"../styles/CalendarListItemHeader.css\";\n\nexport const CalendarListItemHeader = ({\n                                         start\n})=><div className=\"header_4\">\n  <div className=\"header_5\">\n    <div className=\"header_6\">\n      { start[0]} {start[2]}\n    </div>\n  </div>\n</div>;","\nimport React from 'react';\nimport '../styles/CalendarListItem.css';\nimport {Link} from \"react-router-dom\";\nexport const CalendarListItem = (props) => {\n  const {start, duration, subject, location} = props;\n  const encodeEtag = encodeURIComponent(props[\"@odata.etag\"]);\n  return <Link className=\"calendar_3\"  to={`/event-details/${encodeEtag}`}>\n    <div className=\"calendar_4\">\n      <div className=\"calendar_5\">{start && start[1]}</div>\n      <div className=\"calendar_6\">{duration}</div>\n    </div>\n    <div className=\"calendar_7\">\n      <div className=\"calendar_8\" />\n    </div>\n    <div className=\"calendar_9\">\n      <div className=\"calendar_12\">\n        <div className=\"calendar_13\">\n          <div className=\"calendar_14\">{subject}</div>\n        </div>\n        {location &&\n        <div className=\"calendar_15\">\n          <span role=\"img\">&#128205;</span>\n          {location}\n        </div>\n        }\n      </div>\n    </div>\n  </Link>;\n}\n","import {createStore} from 'satcheljs';\n\nexport const getCalendarStore = createStore(\"calendarStore\", {\n    events:{value: []}\n});","import {mutatorAction} from 'satcheljs';\nimport {getCalendarStore} from '../store/getCalendarStore';\n\n// returns a mutator function, which  creates and dispatches and handles, an UPDATE_CALENDAR_ITEMS_MAP action\nexport const updateCalendarItemsMap = mutatorAction(\"UPDATE_CALENDAR_ITEMS_MAP\",(newEvents) => {\n    const calendarStore = getCalendarStore();\n    const {events} = calendarStore;\n   events.value=newEvents.value;\n});\n","const COLOR_SWATCHES_LOOKUP = [\n  'lightGreen',\n  'lightBlue',\n  'lightPink',\n  'green',\n  'darkGreen',\n  'pink',\n  'magenta',\n  'purple',\n  'black',\n  'teal',\n  'blue',\n  'darkBlue',\n  'orange',\n  'darkRed',\n  'red',\n];\n\nexport function sendToSW(message) {\n  if (\"serviceWorker\" in navigator && navigator.serviceWorker.controller) {\n    navigator.serviceWorker.controller.postMessage(message);\n  }\n}\nexport function triggerQueueSync(message) {\n  navigator.serviceWorker.ready.then(function(registration) {\n    registration.sync.register(message);\n  });\n}\n\nexport function getDateTime(datetime, override = true) {\n  if (!datetime) {\n    return ['', '', '', '', ''];\n  }\n  const [_date, _time] = datetime.split(\"T\");\n  const [h, m] = _time.split(\".\")[0].split(\":\");\n  const __date = new Date(_date);\n  let day, time, fullDate;\n  const date = __date.getDate();\n  const currentDate = new Date().getDate();\n  if (override) {\n    if (date === currentDate) {\n      day = \"Today\";\n    } else if (date === currentDate - 1) {\n      day = \"Yesterday\";\n    } else if (date === currentDate + 1) {\n      day = \"Tomorrow\";\n    }\n  }\n\n  [time, day, fullDate] = [`${h}:${m}`, day || __date.toLocaleString('en-us', {weekday: 'long'}), _date];\n  const dateTime = date === currentDate ? time : __date.getMonth() + '/' + date + ' ' + time;\n\n  return [date, time, day, fullDate, dateTime];\n}\n\nexport function getColorFromName(displayName) {\n  let color = 'blue';\n  if (!displayName) {\n      return color;\n  }\n\n  let hashCode = 0;\n  for (let iLen = displayName.length - 1; iLen >= 0; iLen--) {\n      const ch = displayName.charCodeAt(iLen);\n      const shift = iLen % 8;\n      // tslint:disable-next-line:no-bitwise\n      hashCode ^= (ch << shift) + (ch >> (8 - shift));\n  }\n\n  const COLOR_SWATCHES_NUM_ENTRIES = COLOR_SWATCHES_LOOKUP.length;\n\n  color = COLOR_SWATCHES_LOOKUP[hashCode % COLOR_SWATCHES_NUM_ENTRIES];\n\n  return color;\n}","import {getDateTime} from \"../utils\";\nimport {getCalendarStore} from \"../store/getCalendarStore\";\nimport {computed} from \"mobx\";\n\nconst getDuration = (end, start) => {\n    let distance = Math.abs(new Date(end) - new Date(start));\n    const hours = Math.floor(distance / 3600000);\n    distance -= hours * 3600000;\n    const minutes = Math.floor(distance / 60000);\n    return `${hours}:${(\"0\" + minutes).slice(-2)}`;\n};\nexport const getParsedEventsMap = () => {\n    const events = getCalendarStore()?.events;\n    try {\n        const dateGroups = {};\n        events.value.forEach(item => {\n            const start = getDateTime(item?.start?.dateTime);\n            const end = getDateTime(item?.end?.dateTime);\n            const duration = getDuration(item?.end?.dateTime, item?.start?.dateTime);\n            dateGroups[start[3]] = dateGroups[start[3]] || [];\n            const _item = {\n                ...item,\n                itemId: item?.id,\n                subject: item?.subject,\n                isRead: true,\n                start,\n                end,\n                location: item?.location?.displayName,\n                duration\n            };\n            dateGroups[start[3]].push(_item);\n        });\n        return dateGroups;\n    } catch (err) {\n        console.log(\"Error : \" + err);\n    }\n\n};\n\nexport const getActiveEventDetailsByEtag = (activeEtag) =>{\n    const events = getCalendarStore()?.events;\n    const decodedAcTiveEtag = decodeURIComponent(activeEtag);\n    return events?.value?.find(e=>{\n        return e?.[\"@odata.etag\"] === decodedAcTiveEtag;\n    });\n};","import React from 'react';\nimport {CalendarListItemHeader} from \"./CalendarListItemHeader\";\nimport {CalendarListItem} from \"./CalendarListItem\";\nimport config from \"../../Config\";\nimport {getEvents} from \"../../GraphService\";\nimport \"../styles/Calender.css\";\n\nimport {observer} from 'mobx-react';\nimport {updateCalendarItemsMap} from '../actions/calendarActions';\nimport {getActiveEventDetailsByEtag, getParsedEventsMap} from \"../selectors/getCalendarEvents\";\n\nexport const Calendar = observer(class Calendar extends React.Component {\n    async componentDidMount() {\n        try {\n            // Get the user's access token\n            const accessToken = await window.msal.acquireTokenSilent({\n                scopes: config.scopes\n            });\n            // Get the user's events\n            const events = await getEvents(accessToken, this.props.select);\n            // Update the array of events in state\n            events && updateCalendarItemsMap(events);\n        } catch (err) {\n            console.error('ERROR', err);\n        }\n    }\n\n    render() {\n        const eventsMap= getParsedEventsMap();\n        const eventKeys = Object.keys(eventsMap).sort();\n        const activeEtag = this?.props?.match?.params?.etag;\n        if(activeEtag){\n            const eventDetails = getActiveEventDetailsByEtag(activeEtag);\n            return <div dangerouslySetInnerHTML={{__html: eventDetails?.body?.content}}/>;\n        }\n        return <div className=\"mailListContainer\">{\n            eventKeys.map((eventKey, k) => <React.Fragment key={k}>\n                <CalendarListItemHeader start={eventsMap[eventKey][0]?.start}/>\n                {eventsMap[eventKey].map((e, k)=><CalendarListItem key={k} {...e} />)}\n            </React.Fragment>)\n        }\n        </div>;\n    }\n});","import React from 'react';\nimport \"../styles/CalendarHeader.css\";\nexport const CalendarHeader = ({headerText}) =><div className=\"header\" >\n  <div className=\"header-item\">\n      <span>{headerText}</span>\n  </div>\n</div>;\n","import React from 'react';\n\n  import {Calendar} from \"./Calendar\";\n  import {CalendarHeader} from \"./CalendarHeader\";\n\n\nexport const\n    CalendarBox = (props) =><>\n      <CalendarHeader {...props}/>\n      <Calendar {...props}/>\n      </>;\n\n","import React, { Component } from 'react';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\nimport { UserAgentApplication } from 'msal';\nimport ErrorMessage from './ErrorMessage';\nimport config from './Config';\nimport { getUserDetails } from './GraphService';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport {CalendarBox} from './calendar/components/CalendarBox';\n\nconst App = class App extends Component {\n  constructor(props) {\n    super(props);\n    const userAgentApplication = this.userAgentApplication = new UserAgentApplication({\n        auth: {\n            clientId: config.appId,\n            navigateToLoginRequestUrl: false,\n            redirectUri: config.redirectUri\n        }\n    });\n    userAgentApplication.handleRedirectCallback((error, response) => {\n      console.log(error, response.accessToken, response);\n    });\n    var user = this.userAgentApplication.getAccount();\n\n    this.state = {\n      isAuthenticated: (user !== null),\n      user: {},\n      error: null\n    };\n\n    if (user) {\n      // Enhance user object with data from Graph\n      this.getUserProfile();\n    }else{\n      this.login();\n    }\n  }\n\n  render() {\n    let error = null;\n    const {user} =  this.state;\n    if (this.state.error) {\n      error = <ErrorMessage message={this.state.error.message} debug={this.state.error.debug} />;\n    }\n\n    return (\n      <Router>\n            <Route exact path=\"/\"\n              render={(props) =>\n                <CalendarBox {...props}\n                             headerText=\"Calendar\"\n                             user={user}\n                             showError={this.setErrorMessage.bind(this)}\n                             select=\"id,subject,start,end,location,body\"\n                />\n              } />\n            <Route exact path=\"/event-details/:etag\"\n               render={(props, params) =>\n                   <CalendarBox {...props} params={params}\n                                headerText=\"Calendar Details\"\n                                user={user}\n                                showError={this.setErrorMessage.bind(this)}\n                                select={false}\n                   />\n               } />\n      </Router>\n    );\n  }\n\n  setErrorMessage(message, debug) {\n    this.setState({\n      error: {message: message, debug: debug}\n    });\n  }\n\n  async login() {\n    try {\n      await this.userAgentApplication.loginPopup(\n        {\n          scopes: config.scopes,\n          prompt: \"select_account\"\n      });\n      await this.getUserProfile();\n    }\n    catch(err) {\n      var error = {};\n\n      if (typeof(err) === 'string') {\n        var errParts = err.split('|');\n        error = errParts.length > 1 ?\n          { message: errParts[1], debug: errParts[0] } :\n          { message: err };\n      } else {\n        error = {\n          message: err.message,\n          debug: JSON.stringify(err)\n        };\n      }\n\n      this.setState({\n        isAuthenticated: false,\n        user: {},\n        error: error\n      });\n    }\n  }\n\n  logout() {\n    this.userAgentApplication.logout();\n  }\n\n  async getUserProfile() {\n    try {\n      // Get the access token silently\n      // If the cache contains a non-expired token, this function\n      // will just return the cached token. Otherwise, it will\n      // make a request to the Azure OAuth endpoint to get a token\n\n      var accessToken = await this.userAgentApplication.acquireTokenSilent({\n        scopes: config.scopes\n      });\n\n      if (accessToken) {\n        // Get the user's profile from Graph\n        var user = await getUserDetails(accessToken);\n        this.setState({\n          isAuthenticated: true,\n          user: {\n            displayName: user.displayName,\n            email: user.mail || user.userPrincipalName\n          },\n          error: null\n        });\n        document.head.getElementsByTagName(\"title\")[0].text = `Calendar - ${user.displayName} - Outlook`;\n      }\n    }\n    catch(err) {\n      var error = {};\n      if (typeof(err) === 'string') {\n        var errParts = err.split('|');\n        error = errParts.length > 1 ?\n          { message: errParts[1], debug: errParts[0] } :\n          { message: err };\n      } else {\n        error = {\n          message: err.message,\n          debug: JSON.stringify(err)\n        };\n      }\n\n      this.setState({\n        isAuthenticated: false,\n        user: {},\n        error: error\n      });\n    }\n  }\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport { applyMiddleware } from 'satcheljs';\nimport { trace } from 'satcheljs-trace';\n\nconst bootstrap = () => {\n    // Optionally enable some dev tools based on a URL parameter\n    let regex = new RegExp(\"[\\\\?&]devtools=\");\n    let url = window.location.href.toLowerCase();\n    if (regex.exec(url)) {\n        applyMiddleware(require('satcheljs-react-devtools').default, trace);\n    }\n\n    // Render the app\n    ReactDOM.render(<App />, document.getElementById('root'));\n    // If you want your app to work offline and load faster, you can change\n    // unregister() to register() below. Note this comes with some pitfalls.\n    // Learn more about service workers: https://bit.ly/CRA-PWA\n    serviceWorker.unregister();\n};\n\n\nbootstrap();\n\n","module.exports = {\n  appId: '98f6c11f-26a7-4309-a75f-b8df6e384711',\n  redirectUri: 'http://localhost:3000/',\n  scopes: [\n    'user.read',\n    'calendars.read'\n  ]\n};"],"sourceRoot":""}